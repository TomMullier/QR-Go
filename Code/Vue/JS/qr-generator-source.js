import jsPDF from 'jspdf';
import QRCode from 'qrcode';

const doc = new jsPDF();

function createPDF() {
  new Promise(async (resolve) => {
    doc.addImage('../img/fond-page.png', 'PNG', 0, 0, 210, 297);
    doc.addFont('../fonts/Montserrat-regular.ttf', "Montserrat-regular", "normal");

    doc.setFontSize(50);
    doc.setFont('Montserrat-regular');
    doc.text("Step Name", 105, 60, {align: 'center'}, null);

    // add to pdf an image generated by qrcode
    const url = await createQrCode();
    doc.addImage(url, 'PNG', 55, 100, 100, 100);
    doc.save("NOM DU PARCOURS.pdf");
    resolve();
  });
}

async function createQrCode() {
  const options = {
    errorCorrectionLevel: 'L',
    type: 'image/png',
    scale: 10,
    margin: 1,
    color: {
      dark: "#000000",
      light: "#ffffff"
    }
  };

  const content = 'Thomas est cool !!!!';

  return await new Promise((resolve, reject) => {
    QRCode.toDataURL(content, options, (err, url) => {
      if (err) reject(err);
      else resolve(url);
    });
  });
}


document.getElementById('div_scaner_title_txt').addEventListener('click', createPDF);